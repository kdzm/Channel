import string
from requestget import geturl
import time
from  MD5 import get_token
chlist={'广西卫视':'1',"广西综艺":'2',"广西都市":'3',"广西新闻":'4'," 广西公共":'5',"广西影视":'6',"广西国际":'7',"精彩广西":'10'}
#chlist={'广西卫视':'1','广西综艺':'2','广西都市':'3','广西新闻':'4'}
for x in chlist.keys():
    #url='http://tv.gxtv.cn/Tv-'+chlist[x]+'.html'
    url='http://tv.gxtv.cn/TV-'+chlist[x]+'.html'
    headers={'Referer':url,'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.0 Safari/537.36 Edg/75.0.14'}
    r=geturl(url,headers=headers)
    #if x=='广西综艺':
        #print(r)
    n1=r.find("cid': '")+len("cid': '")
    n2=r.find("'",n1)
    n3=r.find("token': '")+len("token': '")
    n4=r.find("'",n3)
    cid=r[n1:n2]
    token=r[n3:n4]
    #print(cid,token)
    t0=time.perf_counter()
    rurl='http://tv.gxtv.cn/player/?cid='+cid+'&token='+token
    t1 = time.perf_counter()
    #print(rurl)
    r2=geturl(rurl,headers=headers)
    #print(r2)
    x1=r2.find('Video_Fluent = "')+len('Video_Fluent = "')
    x2=r2.find('"',x1)
    Video_Fluent=r2[x1:x2]
    y1=r2.find('WsSecret = "')+len('WsSecret = "')
    y2=r2.find('"',y1)
    WsSecret=r2[y1:y2]
    z1=r2.find('WsTime = "')+len('WsTime = "')
    z2=r2.find('"',z1)
    WsTime=r2[z1:z2]
    #t0=time.perf_counter()
    playurl='http://zb.gxtv.cn/live/nn_live'+Video_Fluent+'.flv?wsSecret='+WsSecret+'&wsTime='+WsTime+'&temp_time='+str(t1)
    print(x,playurl)
t=time.time()
tx=t*1000
print(int(tx))
strings={"1":'eJwdyMsKwjAQBdAvEibTZHqzE1cu62PRXcgkRpBooQotJR%2BvuDucZQ3TshuHR73M7jxUf8ftOh0%2B49PN4XgKtBdiKLjnkjSzgXrJYvRX5a%2BGrdr3q7VCNiFHKhFqCdDUG%2B4cRRIvruMvPXQgZw%3D%3D','2':'eJwdyMsKwjAQBdAvEibTzvRmJ65c1seiu5BJjCCVahHaQj5ecXc4yxqmZTf0j%2FEyy7kf%2FR2363T4DE%2BZw%2FEUaK%2FEMHDHJVlmB%2FOa1dmvyl%2F1Dd5eUmuhNiFHKhHWEmCpc9wIRVKv0vAXNXQgLQ%3D%3D','3':'eJwdyMsKwjAQBdAvEibTZHqzE1cu62PRXcgkRpBooQotJR%2BvuDucZQ3TshuHR73M7jxUf8ftOh0%2B49PN4XgKtBdiKLjnkjSzgXrJYvRX5a%2BGrdr3q7VCNiFHKhFqCdDUG%2B4cRRIvruMvPXQgZw%3D%3D'}
for p1,p2 in strings.items():
    p='http://live.stream.tvmcloud.com/token/uatoken?app=js&format=json&string='+p2
    r=geturl(p,headers=headers)
    n1=r.find('user":"')+len('user":"')
    n2=r.find('"',n1)
    user=r[n1:n2]
    n3=r.find('token":"')+len('token":"')
    n4=r.find('"',n3)
    token=r[n3:n4]
    playu='http://live.stream.tvmcloud.com/approve/live?type=ipad&channel=GuangXiCity&access_token='+token+'&user='+user+'&suffix=m3u8'
    print(p1,playu)
    #user=
#http://stream.cdn.liangtv.cn/live/liangtv_gxgg/playlist.m3u8?wsSession=5a1c42b4131e8f133569acac-153434526335605&wsIPSercert=7905038a5d6c3462bfc5362e7ee76afb&wsMonitor=-1  广西公共
a=time.time()
b=int(a)
print(b)
print(get_token(str(b)+'2075356aa9313a299584edb2677b5ee2055f80b9164346c68d103fe6a6a06fc843c983130ebf018630a0dac00324cb832acf482de47bf735740ed0a0444a26507cdf1cc7f5320d2bd0ee793f3ae9c03e857dd49212adeebcd59bcd9702d74a0b0e2ec2f1fe6574242100d0b074b7e455878a7398ce40d82b1ee91348a070958d6f8d6bc47350bf6b767c2e3111ac6920681aad7dc920bd5adcd5dafd7cd63d79cfeaa7764c6c49d5bfbb624411819dea54cfbc5e5c3b5f121e1ad74858d5bbcdbf8d36ced4252253ee4b60d4c110dd1806f4c03b83dc69faa48af63138219c934207654a9f57879c4486d9e2420efcea19fe7bb2bfe2dd63f48d9c845e26d9647aff9fa542d055f737298b574d1278dff0747e047be82999cb5f855ac5e8888e7c5fc5152cefcdc97b8ab6c0d499fc12189594e7ac9ac97c8c593b151e9014976ad21596a1599bd56cfd0d88751417add9dbe48f7f6242d235be73ce9118759caa48c350b6a5a225c7ce422775f581c502d97834c193eb68cb06a87c579db35d6e79db7f7b49d08150bef733554b07bc1987865a0d82ad33fb2ca14422c1feb6e131afc370e0df7e1a0cae419e41d5455b0b8234a1e2e354a675831a5ecebce0a8b39fb7d80871ed0d0812acea13501395f7fbe29e327ea55f8718133dd1e45ec48391ddaa07ff9f72ebbe28dadcdba0b6781a7df954904f3cd72ad08c3622f6602504205d6c35290204258e3c5cc506540f3271f2ff83a1608245cfe782f913132b001f3a2cd65e5a5ffd56216d6dcb25e134c95b1b29082bf239dbdd6c49443496998913ba6323ea1af829837016217dfe1e91070eecfac191410e138a4e40956f1b4f4b721d124a5f1b90eec87755cff6fb4579efbdd152d5aadde72a9d79286d379153c9bd70a3b79724e658894d5f80262c278c41f7cf8441bee27a12c4a02320f41d476601ffcbe239c4b2d2d3f55bad548599a8c4889dd5bacda4e5b221882963ee727926852e7db52fe648325ec2de4f8c3fe7f1e9d009ffc17d85f36666ddb6ba540b311c5878784e9af957c5c5223da3a5b982246b2547fcb48a9e26e90aadbcac9a883308eb63bf4250237c376ec5a5a237396c0ac88e3c1636b8b457bf100119261e06e1e6f6bdb06e3e9a37b9f0bb20e3ac9fbc5e4e635bfef5c4fedabf60f48e379e36d4f5638cb6f421af32d139cc5e705c5b3e8445c6bdf0829c1254999483b7630fee2c8a1396c8b36d5367d88007bd14761bb738cf4524a6558e465766c04735ff994863c680954a431404ee5006d1d4da1fa64c6b8ffe174b234a36b60939e9430c174e0b3b14d828882892dae5e327d1b8ed2dcc420da6d20be895d632239bf7c08eec0d585b3a3e6a3d9db7ada2a6f3f3b965acc87cb47dde5b977d458637b30800ff48169d0c5efbe7b68af320e1a32e913d60644095bc6af8dc96afb653dbf1204ef61ff9610d02410d72f2007b69ecd7cc66fd3b1c4246b6c021c78fda729c1ad61b50618fbe065bed2987f756a4e344411f17e91c00a4230158d865a3f9f749b94a889c84aa130bee69579a016eca0f6cd84d5440f289c89cf1e43a508f94bdb3b9ef60b767287e026745598cfdf6af72c24374fc83199a5201e13f3bd9fb7440617e06517b3e79b032a5308e5040649ccafe5041b8bbc7439fc8b6186e12189338a6014165e6230532f984b07fb0ead855735379fd4172b65ed5826f9d103e0e58a364d8693426096b8b1ccb5dc66650b53f08d341c066854964e7fc5c31ed38334e739db145bc5708419b7d47eeafe97576a807aeb58807bda15b0b07939609a4a6f89e0e1f9ecd2cee342dbce9ba67cb39d1f73a1026ad8233275693cb3dc944fba69e5d9b8629cfdc4655ecbc6b0aee98abd27447aab5babcf4f41c3807e4142709106108e55b94c4b01ea37e786bc5bf9a3de5f84652ab67c182610273e20d5229b3b7094a7cf90027723414aca1c6d326f8b653c5b5a9ccc1dbc19405b618759ba1b86a996b30d00cf1fe6e5246a1d4ffe20135dd7cb8f4c37e8490b079780cbb4031a9ea4a89d3fdefcec31cd4c087f817c76f475dd6cd807277074a7c43128fd049719af5f1fc7d4447b45d5b60ed54e51c4fa6567b34c3f0a5567a1cde1421da705facb34672181fb6ce4151911936e72feda1e9e7e8001099570b200f4cbc5b5cb14cedc01a915b0533829fdc0cf8ebd9d9717099965a3277586d6ac134c613fa3829bd652434dde74eb5b3bafad1c2e04c3c24eb27e4ed9ad3a25a3cc777a1e5a53e4a250606a031445fbbb081eff35682c50b970787eed80545bfe5782342c12bccefd7183d54929ec63280cbbb43d06c2410af54ecf935d2564471c3a3ed949f52ee1c22411b379ccb50d366a7ecd10a5911766f7d58703c9f09259e244ceb9c92c18fde000429b3fb66107a2f8134d8025bdc1896303004ce17c0a9539d9ff6ca4f53a5030ce33cfccd86169bc3aa7fba5ea46ce2238c717497d0108c8ea6319c149741a2845b6242388a448df27be601f9337e31b605efb7f0c61a30b51c5da6f9f58fe0276377fca71fefed57135fb74947c6468d80aebcf032a2c04f3fead5e26fa1dc93dfede2bd33ef688811f6d6f56a4220ef859db7d37ea5648476dc36b50ba0a15d580f284ba73911ab2f2b3d24b78971a926e6bfc170d8afe61ad9415f1ca5c6b714e6772dc1f533ca09008c030560b16b67d368e3b9606ba910afa5db4cc5ac92e3d3284f702b16403edf6fa4c514d641ad55596b2256dd491f01f2c0a4473bed5c6630fde832de03017459256c07b0714efbf916020545c80b3c3d723e538de217b7367efb71a016ff2311ee09a0439cee5c253d4e0d12688da443c77758e0220b867f2e137ba88d793a96bfcefd612b4080c070dff0a060f040e4f35fb230bfb5750d79d5452908fc8299eb0372cfd596cfd0e3372522ebca323b93af5ad7102a4a376e4cdf219387f8b9620e97b306e5004fd2a08e34c1acfcb6f8e91cced6bea06db8799fb80447e28653f3d1e02261eab50ac5622daf7402decb6bd7edbcf79c6831f5670d14a37c7df7a69572c310a18fb5e8433c4d5c540560bf22d201b17216bee132d98a641066745d1e9f2f7c29649226b13c919da77ceadd648926bd9609dd35abeaf493c61cc906e9779f7d7e19eb654fb83228e5b08e4f8c16925d5340a99d5d225f2b8039fb1bf4dc257efe9f33d4296c64219090fac16338607b00595c29ed9d48c26965b838bd346f28e536a1cb2bf28cd99b7a325b656a01ed4c700eadfdef0b425d96eb681746724b363b4dfb2209784876e19d022c8b684f645f08174bdc002165d1f684235cc47a058b8c2fd917c15ce4fc13f06aca11faa79d6d9ad961a9e9e4731075bacc4ffc3e425e3e7871f7c1a1d413af1b5c0e60c00ced31f518ae3999e28759ab2e57a885066d6b549a8dd765a8adf62da493055edd95f26ba0218bc840400ec02ed912e707388eeee621451c88a9d101a56affb7ce8787f02083ff602201627e24bcad60c3ecb3c5de038b3dfabc076f9e67447a6e5846fd3693781f7a72fab0bde4bae19b647bf0dc5018fddbd217aa31b4afad14d0087b88f3d5b3ecebcc45e1d5db4dee5d07c3c5b6e5c1af2cb0a34d33798de2fd23dd73cca2a699f372003f369b2686f9b56d49afd81d05aaafb20252f657e38248b6748687033221ab167ebfbccae3ef4241d9a06361a76682fee91d129667ea85796eefbe33daaed82e981ac7684e9d456d4a5ea5dcacdc3d45c213731c7563a702595aff8379b7d637961e1127232cd97432a79fe57aafabfacf95974bb5e6dafb1a9c14e504bbe2515aec6bcead25808a7574d26b6898b481f6915504868c9cda2a8979882af4bf4023b289e47bf617b7b9dc46e131d4c203c827532687f863c42b00c07691eaa3b0d6031165e518aa6157162623178a7a253ec930804615d7aec1e2748bd1af5772bbf61ca2e6e062a5a1179583c8c8422c1724cd722b740cde72b2c8cc5859f9f9885d2d1fe774ab6b8a77329a61368d9c26831a97cb2190c3aff1cde342186280c8801d943924dd5420231cc5fdd41673da0e60296a3e343c5f7f031e66b2e325c39cb3d7e64b18a27795db46c0400d0bc986d660a2aa02b3dff3e92df66958b81236e5acf7d18e48814887e9dbfe1c79288a4b05268625830cbd3803052f4e7afa90172d1b89f3111b7501dad6c88a219f241bdb6814c8f2d4fba3fab46f178b607488d52c7ab22d7778077a1a46aa5eae14aeffae311732990ba2e8144f8ec995a6e7642db9f7943982a3ea128054f0d4f51fda39ae8e4fb81a70c917ef527541e8cccd75bcbb008dcedb7d9f20ec78e502ea792927a9c6bfeff13017861ffa393ecd2db05e16177c889ccdf0fc27ef19d803f522b4668367a742f4a24f3661da0cdc1b64864cdf70e6b65c8816734ea7dd5622d0441420fcf848fb077f46ae875aec3cb616c22c40e884a2c7d9308702c0a9b0e2796d0e839f45e7297fb5840bc93be327fa9807db4f37fd0514b9ff8d6543ce01ae0d2bfe2a6940226b4f22cb148556134b0d5b23fdf2ca5677b1e28c531460da4387f61837062a7877332d20b1eca2f691f7c44a28052cbdee91691db1364a4448dfea0adf9af42f0fffcb0dd2b214a55ae7ed47e29fdfafccc4f2840eef55054b2a65e1836d44d0d8a90d2250e3e40a45d86f59a56b7859aaf0ab4c51c773f45ae2b12d263ace0c97299626c927073eeccced0ab6315c578abe70bf95cac9b4b518254f975adc1c6fcec93b96d2fe81fcd67e6d5e6126ff5a19d7c609746fbb43e3368a0c8f921a764c4b36de50ce87ab639b6afe5431faad79aa2558f3c787151bec9450f44034e997e0d369864016aed8400d42448d717a46025b2acc9193a8712c1945bb3ed2d20fc504d4194bc36312f7f0235eb5e59e0096a7c1c50d6a4d5c9db7d3aeb6fa88be893ed39fb31fcde31c08635f1eba4bf3d16222ec59d89ebd9471b467a77a844ca044ec95e2ee7d062b00bb5774b22aa5e3b72b6a423b1778a8443b60e68c3211a4e68154fddf144e5521b8347aed34aeb57759b25f3b0663804434560be3c35011dbac9629d2ae95e1b9e8fab438d55c4f73663a956af696a805db32ef8641f6cace411d3ce82d5dee28d84d41c7e12eb95887b7f0709337902843dc1573898e5b73845908fc47c9b5a098e4e9484899f13256299c46529103ffed805f3d964c6370d19de0621d70ba3a467fd23fe2a109e092b2467b0c392321ec5247e5c037fc18ad98b7773c53f432374afc283f1c57596b6114e0685487bc838d2a3b08904b12121d050c17400b52812727af62e3ee2eea52eed9f94c1eaab5e5fc537d8da8c53a3e620b7cb76254f05557b10e939b78d4b8f5fdc642fec96e93731dbbb3e4a971d8464a0fee09fe1d92b10e63c562f1cad5c1aced3c9d4021e4b7f8bd04971a64c00b6e4ee68a4fc8e815e493ec7842850109987e4f8f442d24dff8408935db14b0d29680f05ef1f2e626b1dcded79749f99102c6f1d65e5c579501bee16430952c29f6b37e751265bc461e8cc508fa58537deb81bd23a86cd5d0f70ce5ebee1e2e0d334b8fd0c060e4f1814902d610512353ab183620970c121269ac4385145b08681daa8b2dec9cf3681a6c9b1d5bc767bff193d7567d0b974aa6a6fac8954bb1dbfa09e225feab4fbdb11a84ed83fdf7705a7790b57f0f229fbfca648191e824d1df84399dd5d3a885bb2f66e607572df9cd4cbde3378418708f196fa79fb062b40b55a14b06501162686954b521d8d753dc3bd90db6a4c02d879d72a273183b8847ebad0087bd73d3305b705f72eaa5d206ea03d7ea364b1342ea40abd042c7c461829d6202518d29a21e75303e2a6aa3da1831539257bbff377ae924fed5b2f5c54aada1ccba3e385f1e633d3919b88582f626adc022b936f252c3432fee14445f587656f7ecdaa2634384f7e49d567490668d5bd6616fde0213aec3e3ce13a4fd8b12253796ffb4e58db2bef095939da60deedd91101c216b9828943b233a7c8fe20b8105f3180fd0e21d08b3ff710bbed810c7b0734c4f334333444ed0580f12f62f3a1f995850e930ce1267275e6b77c41a13e53e3fed2f104015328deafb6aae7464ef5da1ddf0c961e46895999716e2c85cf8153f306cd748643454aee6c28c921d32b3705eac50b932700df4269682f79678eb57da622a9d2f719b900ede41b3892d4d08b4262454577fc466e0e6f180931120bd5d2c52fab7442cc72fdff80de11d'))
#http://cnlive3.videocc.net/vod1/cctv1/01.m3u8?wsSecret=9620671226a6e134749d97e8dde095ff&wsTime=1556613304